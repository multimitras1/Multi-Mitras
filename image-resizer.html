<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Resizer ‚Äî KathaByte Tools</title>

<!-- JSZip for ZIP download -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<style>
:root{
  --bg1:#eaf6ff;
  --blue-deep:#0d47a1;
  --blue-mid:#0077d6;
  --accent:#00c3ff;
  --card-radius:14px;
  --text-dark:#042a4a;
  --glass: rgba(255,255,255,0.88);
}
*{box-sizing:border-box;}
body{
  margin:0;
  min-height:100vh;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  background: radial-gradient(1200px 600px at 10% 10%, rgba(0,195,255,0.06), transparent),
              linear-gradient(135deg,#e6f4ff 0%, #ffffff 60%);
  color:var(--text-dark);
  display:flex;
  align-items:start;
  justify-content:center;
  padding:20px;
}
.wrap{
  width:100%;
  max-width:1100px;
  display:grid;
  grid-template-columns:1fr 320px;
  gap:18px;
  align-items:start;
}
.card{
  background: linear-gradient(180deg, rgba(255,255,255,0.94), rgba(255,255,255,0.90));
  border-radius:var(--card-radius);
  padding:16px;
  box-shadow:0 10px 30px rgba(3,54,120,0.06);
  border:1px solid rgba(13,71,161,0.06);
}
header.card{
  grid-column:1/-1;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
h1{margin:0;font-size:18px;color:var(--blue-deep);display:flex;gap:10px;align-items:center;}
p.lead{margin:6px 0 0;color:#0b4b72;font-size:13px;}

.uploader{
  border-radius:10px;
  padding:18px;
  background: linear-gradient(180deg, rgba(13,71,161,0.03), rgba(13,71,161,0.015));
  border:1px dashed rgba(13,71,161,0.06);
  display:flex;
  flex-direction:column;
  gap:12px;
  align-items:center;
  justify-content:center;
  min-height:180px;
}
.drop{
  width:100%;
  padding:16px;
  border-radius:10px;
  text-align:center;
  cursor:pointer;
  background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.98));
  box-shadow:0 6px 18px rgba(0,195,255,0.04);
  border:1px solid rgba(13,71,161,0.04);
}
.drop input{display:none;}
.small{font-size:13px;color:#0b4b72;}

.row{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;}
button.primary{background:linear-gradient(90deg,var(--accent),var(--blue-mid));color:#fff;border:none;cursor:pointer;font-weight:700;}
button.ghost{background:transparent;border:1px dashed rgba(13,71,161,0.06);color:var(--blue-mid);cursor:pointer;}
.preview-list{margin-top:12px;display:grid;gap:10px;max-height:520px;overflow:auto;padding-right:6px;}
.preview-item{display:flex;gap:12px;align-items:center;padding:10px;border-radius:10px;background:#fff;border:1px solid rgba(13,71,161,0.04);}
.preview-item img{width:96px;height:64px;object-fit:cover;border-radius:8px;}
.meta{font-size:13px;color:#0b4b72;}
.meta b{color:var(--blue-deep);}
.controls-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;}
.right-col{display:flex;flex-direction:column;gap:12px;}
.ad-slot{margin:12px 0;text-align:center;}
footer{grid-column:1/-1;margin-top:6px;font-size:12px;color:#0b4b72;text-align:center;}
@media(max-width:1000px){.wrap{grid-template-columns:1fr}.right-col{order:-1}}
@media(max-width:420px){.preview-item img{width:72px;height:52px}}
</style>
</head>
<body>
<div class="wrap">

<header class="card">
  <div>
    <h1>üñºÔ∏è Image Resizer</h1>
    <p class="lead">Resize images in-browser ‚Äî keep aspect ratio or set width/height.</p>
  </div>
  <div style="min-width:220px;text-align:right">
    <!-- Top Banner Ad (728x90) -->
    <div class="ad-slot" aria-hidden>
      <script type="text/javascript">
        atOptions = {'key':'a4236a38fef8b51c08a860f7e29b1a32','format':'iframe','height':90,'width':728,'params':{}};
      </script>
      <script type="text/javascript" src="//lightingshovestature.com/a4236a38fef8b51c08a860f7e29b1a32/invoke.js"></script>
    </div>
  </div>
</header>

<section class="card">
  <div class="uploader" id="uploader">
    <div class="drop" id="dropzone">
      <input type="file" id="fileInput" accept="image/*" multiple>
      <div style="font-weight:700;color:var(--blue-deep)">Click or Drop images here</div>
      <div class="small">Supported: JPEG, PNG, WebP</div>
    </div>

    <div class="controls-grid">
      <div>
        <label for="width">Width (px)</label>
        <input id="width" type="number" min="0" value="0">
      </div>
      <div>
        <label for="height">Height (px)</label>
        <input id="height" type="number" min="0" value="0">
      </div>
      <div style="grid-column:1/-1">
        <label><input type="checkbox" id="keepRatio" checked> Maintain aspect ratio</label>
      </div>
    </div>

    <div class="row">
      <button class="primary" id="resizeBtn">Resize Selected</button>
      <button class="ghost" id="clearBtn">Clear</button>
      <button class="ghost" id="downloadAllBtn">Download All (ZIP)</button>
    </div>
  </div>

  <div class="preview-list" id="previewList">
    <div class="small" style="opacity:.8">No images yet ‚Äî upload to start resizing.</div>
  </div>

  <!-- Middle Ad (300x250) -->
  <div class="ad-slot" aria-hidden>
    <script type="text/javascript">
      atOptions = {'key':'8a02d9520d2faa074d27d1b1582d7bf6','format':'iframe','height':250,'width':300,'params':{}};
    </script>
    <script type="text/javascript" src="//lightingshovestature.com/8a02d9520d2faa074d27d1b1582d7bf6/invoke.js"></script>
  </div>
</section>

<aside class="card right-col">
  <div>
    <label class="small">Selected files</label>
    <div id="summary" class="small">0 files ¬∑ Total original: 0 KB</div>
  </div>
  <div>
    <label class="small">Last operation</label>
    <div id="lastOp" class="small">‚Äî</div>
  </div>
  <!-- Side ad (160x300) -->
  <div class="ad-slot" aria-hidden>
    <script type="text/javascript">
      atOptions = {'key':'962ff242b01ed125eb9b14423f7dbd3f','format':'iframe','height':300,'width':160,'params':{}};
    </script>
    <script type="text/javascript" src="//lightingshovestature.com/962ff242b01ed125eb9b14423f7dbd3f/invoke.js"></script>
  </div>
  <!-- Bottom small banner (468x60) -->
  <div class="ad-slot" aria-hidden>
    <script type="text/javascript">
      atOptions = {'key':'496188380e746eef901d9058c8f77c85','format':'iframe','height':60,'width':468,'params':{}};
    </script>
    <script type="text/javascript" src="//lightingshovestature.com/496188380e746eef901d9058c8f77c85/invoke.js"></script>
  </div>
</aside>

<footer class="card">
  Image Resizer ‚Ä¢ Client-side resizing ‚Äî no upload to server required.
</footer>
</div>

<script>
const dropzone=document.getElementById('dropzone');
const fileInput=document.getElementById('fileInput');
const previewList=document.getElementById('previewList');
const widthEl=document.getElementById('width');
const heightEl=document.getElementById('height');
const keepRatioEl=document.getElementById('keepRatio');
const resizeBtn=document.getElementById('resizeBtn');
const clearBtn=document.getElementById('clearBtn');
const downloadAllBtn=document.getElementById('downloadAllBtn');
const summary=document.getElementById('summary');
const lastOp=document.getElementById('lastOp');
let files=[];

['dragenter','dragover'].forEach(e=>dropzone.addEventListener(e,ev=>{ev.preventDefault();dropzone.style.boxShadow='0 8px 22px rgba(0,195,255,0.12)';}));
['dragleave','drop'].forEach(e=>dropzone.addEventListener(e,ev=>{ev.preventDefault();dropzone.style.boxShadow='';}));
dropzone.addEventListener('drop',e=>{const dt=e.dataTransfer;if(dt&&dt.files)handleFiles(dt.files);});
dropzone.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',e=>handleFiles(e.target.files));

function handleFiles(fileList){
  const arr=Array.from(fileList).filter(f=>f.type.startsWith('image/'));
  if(!arr.length){alert('Please select image files.');return;}
  arr.forEach(f=>{const url=URL.createObjectURL(f);files.push({file:f,url,blob:null});});
  renderPreviews();
}

function renderPreviews(){
  previewList.innerHTML='';
  if(!files.length){previewList.innerHTML='<div class="small" style="opacity:.8">No images yet ‚Äî upload to start resizing.</div>';summary.innerText='0 files ¬∑ Total original: 0 KB';return;}
  let totalOrig=0;
  files.forEach((item,idx)=>{
    totalOrig+=item.file.size;
    const div=document.createElement('div');
    div.className='preview-item';
    div.innerHTML=`
      <img src="${item.url}" alt="${item.file.name}" />
      <div style="flex:1;text-align:left">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">${item.file.name}</div>
          <div style="font-size:13px;color:#0b4b72">${(item.file.size/1024).toFixed(1)} KB</div>
        </div>
        <div class="meta">
          <div>Output: ${item.blob?(item.blob.size/1024).toFixed(1)+' KB':'Not resized'}</div>
          <div style="margin-top:6px">
            <button class="ghost" data-idx="${idx}" data-action="resize">Resize</button>
            <button class="ghost" data-idx="${idx}" data-action="download" ${item.blob?'':'disabled'}>Download</button>
            <button class="ghost" data-idx="${idx}" data-action="remove">Remove</button>
          </div>
        </div>
      </div>`;
    previewList.appendChild(div);
  });
  summary.innerText=`${files.length} files ¬∑ Total original: ${(totalOrig/1024).toFixed(1)} KB`;
  attachButtons();
}

function attachButtons(){
  previewList.querySelectorAll('button[data-action]').forEach(btn=>{
    btn.addEventListener('click',async e=>{
      const idx=+e.currentTarget.getAttribute('data-idx');
      const action=e.currentTarget.getAttribute('data-action');
      if(action==='resize'){await resizeSingle(idx);}
      else if(action==='download'){downloadBlob(files[idx].blob,files[idx].file.name);}
      else if(action==='remove'){URL.revokeObjectURL(files[idx].url);files.splice(idx,1);renderPreviews();}
    });
  });
}

resizeBtn.addEventListener('click',async()=>{
  if(!files.length){alert('No images selected');return;}
  lastOp.innerText='Resizing all...';
  for(let i=0;i<files.length;i++){await resizeSingle(i);}
  lastOp.innerText='All images resized ‚úÖ';
});

clearBtn.addEventListener('click',()=>{
  files.forEach(f=>URL.revokeObjectURL(f.url));
  files=[];
  renderPreviews();
  lastOp.innerText='Cleared';
});

downloadAllBtn.addEventListener('click',async()=>{
  if(!files.length){alert('No files.');return;}
  const zip=new JSZip();
  let any=false;
  for(let i=0;i<files.length;i++){
    const f=files[i];
    if(f.blob){any=true;zip.file(f.file.name,await f.blob.arrayBuffer());}
  }
  if(!any){alert('No resized files ‚Äî resize first.');return;}
  lastOp.innerText='Creating ZIP...';
  const content=await zip.generateAsync({type:"blob"});
  downloadBlob(content,'resized-images.zip');
  lastOp.innerText='ZIP ready ‚úÖ';
});

async function resizeSingle(idx){
  const item=files[idx];
  lastOp.innerText=`Resizing ${item.file.name}...`;
  const maxW=parseInt(widthEl.value)||0;
  const maxH=parseInt(heightEl.value)||0;
  const keepRatio=keepRatioEl.checked;
  try{
    const img=await loadImage(item.url);
    let targetW=img.width,targetH=img.height;
    if(maxW>0||maxH>0){
      if(keepRatio){
        const ratio=Math.min(maxW>0?maxW/targetW:1,maxH>0?maxH/targetH:1);
        targetW=Math.round(targetW*ratio);targetH=Math.round(targetH*ratio);
      } else {if(maxW>0)targetW=maxW;if(maxH>0)targetH=maxH;}
    }
    const canvas=document.createElement('canvas');
    canvas.width=targetW;canvas.height=targetH;
    const ctx=canvas.getContext('2d');ctx.drawImage(img,0,0,targetW,targetH);
    const blob=await new Promise(res=>canvas.toBlob(res,'image/png',0.95));
    item.blob=blob;renderPreviews();
    lastOp.innerText=`Resized ${item.file.name} ‚Üí ${(blob.size/1024).toFixed(1)} KB`;
  }catch(err){console.error(err);alert('Resize failed: '+err.message);lastOp.innerText='Error during resize';}
}

function loadImage(url){return new Promise((res,rej)=>{const img=new Image();img.onload=()=>res(img);img.onerror=e=>rej(new Error('Image load failed'));img.src=url;});}

function downloadBlob(blob,filename){const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=filename;document.body.appendChild(a);a.click();setTimeout(()=>{URL.revokeObjectURL(a.href);a.remove();},5000);}
window.addEventListener('unload',()=>files.forEach(f=>URL.revokeObjectURL(f.url)));
</script>
</body>
</html>
